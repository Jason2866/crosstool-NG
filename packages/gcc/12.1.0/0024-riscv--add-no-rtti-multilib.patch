From e8f21edcd90f8dcfe0162ccfb13e3ed9646e109a Mon Sep 17 00:00:00 2001
From: Anton Maklakov <anton@espressif.com>
Date: Thu, 30 Dec 2021 14:15:19 +0700
Subject: [PATCH] riscv: add no-rtti multilib

---
 gcc/config/riscv/t-elf-multilib | 27 +++++++++++++++++++++------
 1 file changed, 21 insertions(+), 6 deletions(-)

diff --git a/gcc/config/riscv/t-elf-multilib b/gcc/config/riscv/t-elf-multilib
index 88f2d18892e1..d2ca83af4ab1 100644
--- a/gcc/config/riscv/t-elf-multilib
+++ b/gcc/config/riscv/t-elf-multilib
@@ -1,6 +1,6 @@
-# This file was generated by multilib-generator with the command:
+# This file was manually edited (fno-rtti multilib added) from a generated by multilib-generator with the command:
 #  ./multilib-generator rv32i-ilp32--c,m,ac rv32imc-ilp32-rv32imac- rv32imafc-ilp32f-rv32imafdc-
-MULTILIB_OPTIONS = march=rv32i/march=rv32ic/march=rv32im/march=rv32iac/march=rv32imc/march=rv32imac/march=rv32imafc/march=rv32imafdc/march=rv32gc mabi=ilp32/mabi=ilp32f
+MULTILIB_OPTIONS = march=rv32i/march=rv32ic/march=rv32im/march=rv32iac/march=rv32imc/march=rv32imac/march=rv32imafc/march=rv32imafdc/march=rv32gc mabi=ilp32/mabi=ilp32f fno-rtti
 MULTILIB_DIRNAMES = rv32i \
 rv32ic \
 rv32im \
@@ -10,13 +10,28 @@ rv32imac \
 rv32imafc \
 rv32imafdc \
 rv32gc ilp32 \
-ilp32f
-MULTILIB_REQUIRED = march=rv32i/mabi=ilp32 \
+ilp32f \
+no-rtti
+
+MULTILIB_REQUIRED = \
+fno-rtti \
+march=rv32i/mabi=ilp32 \
+march=rv32i/mabi=ilp32/fno-rtti \
 march=rv32imc/mabi=ilp32 \
-march=rv32imafc/mabi=ilp32f
-MULTILIB_REUSE = march.rv32i/mabi.ilp32=march.rv32ic/mabi.ilp32 \
+march=rv32imc/mabi=ilp32/fno-rtti \
+march=rv32imafc/mabi=ilp32f \
+march=rv32imafc/mabi=ilp32f/fno-rtti
+
+MULTILIB_REUSE = \
+march.rv32i/mabi.ilp32=march.rv32ic/mabi.ilp32 \
+march.rv32i/mabi.ilp32/fno-rtti=march.rv32ic/mabi.ilp32/fno-rtti \
 march.rv32i/mabi.ilp32=march.rv32im/mabi.ilp32 \
+march.rv32i/mabi.ilp32/fno-rtti=march.rv32im/mabi.ilp32/fno-rtti \
 march.rv32i/mabi.ilp32=march.rv32iac/mabi.ilp32 \
+march.rv32i/mabi.ilp32/fno-rtti=march.rv32iac/mabi.ilp32/fno-rtti \
 march.rv32imc/mabi.ilp32=march.rv32imac/mabi.ilp32 \
+march.rv32imc/mabi.ilp32/fno-rtti=march.rv32imac/mabi.ilp32/fno-rtti \
 march.rv32imafc/mabi.ilp32f=march.rv32imafdc/mabi.ilp32f \
+march.rv32imafc/mabi.ilp32f/fno-rtti=march.rv32imafdc/mabi.ilp32f/fno-rtti \
 march.rv32imafc/mabi.ilp32f=march.rv32gc/mabi.ilp32f
+march.rv32imafc/mabi.ilp32f/fno-rtti=march.rv32gc/mabi.ilp32f/fno-rtti